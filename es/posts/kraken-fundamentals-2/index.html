

<!DOCTYPE html>
<html lang="es" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="false"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="es" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Kraken Fundamentals - II &middot; MakeMalware</title>
  <meta name="title" content="Kraken Fundamentals - II &middot; MakeMalware" />
  
  <meta name="description" content="El sitio donde publico mis cosas" />
  
  
  
  <link rel="canonical" href="https://makemalware.com/es/posts/kraken-fundamentals-2/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.4e796ed43316d82034b8a6e36199f924d2032484b00c0658c01ecc28cf6ed0deb179f70c978b461b68facbdf79aad0e6e522051d7be8ab4191d0bb1f92bade7f.css"
    integrity="sha512-Tnlu1DMW2CA0uKbjYZn5JNIDJISwDAZYwB7MKM9u0N6xefcMl4tGG2j6y995qtDm5SIFHXvoq0GR0Lsfkrrefw==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.a75d508cf75a202afc48fe649516720f8036bda3657897f6cc07dab21f94fa9c3933edbbfc2936f8d3a426f45ac6153237a48aec9115147c5e03db1c5b62b8bc.js"
    integrity="sha512-p11QjPdaICr8SP5klRZyD4A2vaNleJf2zAfash&#43;U&#43;pw5M&#43;27/Ck2&#43;NOkJvRaxhUyN6SK7JEVFHxeA9scW2K4vA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js"
    integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ&#43;dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5&#43;a8AgFUkA==" data-copy="" data-copied=""></script>
  
  <script src="/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Kraken Fundamentals - II" />
<meta property="og:description" content="Dos piezas fundamentales en la l贸gica de Kraken son los M贸dulos y los Agentes. A trav茅s de estos componentes, se entender谩 como Kraken realiza la ejecuci贸n de c贸digo y aprovecha su dise帽o y arquitectura para aportar al operador cierta flexibilidad y comodidad durante la fase de post-explotaci贸n." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://makemalware.com/es/posts/kraken-fundamentals-2/" /><meta property="og:image" content="https://makemalware.com/es/posts/kraken-fundamentals-2/featured.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-17T00:00:00+00:00" /><meta property="og:site_name" content="MakeMalware" />
<meta property="og:see_also" content="https://makemalware.com/es/posts/kraken-fundamentals-1/" />


  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://makemalware.com/es/posts/kraken-fundamentals-2/featured.jpg"/>
<meta name="twitter:title" content="Kraken Fundamentals - II"/>
<meta name="twitter:description" content="Dos piezas fundamentales en la l贸gica de Kraken son los M贸dulos y los Agentes. A trav茅s de estos componentes, se entender谩 como Kraken realiza la ejecuci贸n de c贸digo y aprovecha su dise帽o y arquitectura para aportar al operador cierta flexibilidad y comodidad durante la fase de post-explotaci贸n."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Kraken Fundamentals - II",
    "headline": "Kraken Fundamentals - II",
    "description": "Dos piezas fundamentales en la l贸gica de Kraken son los M贸dulos y los Agentes. A trav茅s de estos componentes, se entender谩 como Kraken realiza la ejecuci贸n de c贸digo y aprovecha su dise帽o y arquitectura para aportar al operador cierta flexibilidad y comodidad durante la fase de post-explotaci贸n.",
    "abstract": "Dos piezas fundamentales en la l贸gica de Kraken son los M贸dulos y los Agentes. A trav茅s de estos componentes, se entender谩 como Kraken realiza la ejecuci贸n de c贸digo y aprovecha su dise帽o y arquitectura para aportar al operador cierta flexibilidad y comodidad durante la fase de post-explotaci贸n.",
    "inLanguage": "es",
    "url" : "https:\/\/makemalware.com\/es\/posts\/kraken-fundamentals-2\/",
    "author" : {
      "@type": "Person",
      "name": "Ra煤l Caro Teixid贸"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-01-17T00:00:00\u002b00:00",
    "datePublished": "2023-01-17T00:00:00\u002b00:00",
    
    "dateModified": "2023-01-17T00:00:00\u002b00:00",
    
    "keywords": ["kraken","webshell","redteam"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2943"
  }]
  </script>


  
  
  <meta name="author" content="Ra煤l Caro Teixid贸" />
  
  
  
  <link href="https://github.com/secu77" rel="me" />
  
  
  <link href="https://gitlab.com/secu77" rel="me" />
  
  
  <link href="https://www.linkedin.com/in/raul-caro-teixido" rel="me" />
  
  
  <link href="https://twitter.com/secu_x11" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.js" integrity=""></script>







<script defer type="text/javascript" src="/js/mermaid.bundle.07f359f8c7eef0d077fac7a4a26544890ee6bbc11985ddbcae52d6f9a97ce9e336f13f25d1a9f94dbece053d4e31f9f559b5b3fcec400c4a804e6d0c71916ee6.js"
  integrity="sha512-B/NZ&#43;Mfu8NB3&#43;sekomVEiQ7mu8EZhd28rlLW&#43;al86eM28T8l0an5Tb7OBT1OMfn1WbWz/OxADEqATm0McZFu5g=="></script>
















  
  
  
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C525RCJNLJ"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-C525RCJNLJ', { 'anonymize_ip': false });
}
</script>



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Ir al contenido</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/es/" class="flex">
            <span class="sr-only">MakeMalware</span>

            <img src="/img/logo.png" width="144" height="144"
                class="max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="MakeMalware" />

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="/es/" class="text-base font-medium text-gray-500 hover:text-gray-900">MakeMalware</a>


        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12">

            
            
            
  <a href="/es/about/"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Sobre mi">
        Sobre m铆
    </p>
</a>


            
            
  <a href="/es/posts/"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
        Art铆culos
    </p>
</a>


            
            
  <a href="/es/resume/"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Resumen">
        Resumen
    </p>
</a>


            
            
  <a href="/es/projects/"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Proyectos">
        Proyectos
    </p>
</a>


            
            

            
<div>
  <div class="cursor-pointer flex items-center nested-menu">
    <a class="text-base font-medium text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II"></a>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/es/posts/kraken-fundamentals-2/" class="flex items-center">
          <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II">
            ES
          </p>
        </a>
        
        <a href="/posts/kraken-fundamentals-2/" class="flex items-center">
          <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II">
            EN
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>


            
            <button id="search-button" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            
<div>
  <div class="cursor-pointer flex items-center nested-menu">
    <a class="text-base font-medium text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II"></a>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/es/posts/kraken-fundamentals-2/" class="flex items-center">
          <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II">
            ES
          </p>
        </a>
        
        <a href="/posts/kraken-fundamentals-2/" class="flex items-center">
          <p class="text-sm font-sm text-gray-500 hover:text-gray-900" title="Kraken Fundamentals - II">
            EN
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>


            
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li>
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    

                    
  <li class="mt-1">
    <a href="/es/about/"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Sobre mi">
            Sobre m铆
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href="/es/posts/"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Posts">
            Art铆culos
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href="/es/resume/"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Resumen">
            Resumen
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href="/es/projects/"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Proyectos">
            Proyectos
        </p>
    </a>
</li>



                    
                    

                </ul>
                

            </div>
        </label>
    </div>
</div>




  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/es/"
      >MakeMalware</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/es/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/es/posts/kraken-fundamentals-2/"
      >Kraken Fundamentals - II</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Kraken Fundamentals - II
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      




































<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-01-17 00:00:00 &#43;0000 UTC">17 enero 2023</time><span class="px-2 text-primary-500">&middot;</span><span>2943 palabras</span><span class="px-2 text-primary-500">&middot;</span><span title="Tiempo de lectura">14 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
     <div style="cursor: pointer;" onclick="window.open(&#34;/es/authors/secu/&#34;,'_self')">secu</div>
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/es/categories/persistence/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    Persistence
  </span>
</span>

  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/es/categories/defense-evasion/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    Defense Evasion
  </span>
</span>

  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/es/tags/kraken/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    kraken
  </span>
</span>

  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/es/tags/webshell/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    webshell
  </span>
</span>

  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/es/tags/redteam/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    redteam
  </span>
</span>

  </span>
  
  
  
  
</div>



    </div>
  </header>
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
     
    <div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky  lg:top-[140px] ">
        <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Tabla de contenido
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#m贸dulos-de-kraken">M贸dulos de Kraken</a>
      <ul>
        <li><a href="#qu茅-es-un-m贸dulo">驴Qu茅 es un m贸dulo?</a></li>
        <li><a href="#tipos-de-m贸dulos">Tipos de m贸dulos</a></li>
        <li><a href="#jerarqu铆a-de-los-m贸dulos">Jerarqu铆a de los m贸dulos</a></li>
        <li><a href="#estructura-de-un-m贸dulo">Estructura de un m贸dulo</a></li>
        <li><a href="#configuraci贸n-de-los-m贸dulos">Configuraci贸n de los m贸dulos</a></li>
        <li><a href="#otras-consideraciones">Otras consideraciones</a></li>
      </ul>
    </li>
    <li><a href="#agentes-de-kraken">Agentes de Kraken</a>
      <ul>
        <li><a href="#qu茅-es-un-agente">驴Qu茅 es un Agente?</a></li>
        <li><a href="#tipos-de-agentes">Tipos de Agentes</a></li>
        <li><a href="#estructura-general">Estructura general</a></li>
        <li><a href="#ejecutores-disponibles">Ejecutores disponibles</a></li>
      </ul>
    </li>
    <li><a href="#conclusiones">Conclusiones</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Tabla de contenido
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#m贸dulos-de-kraken">M贸dulos de Kraken</a>
      <ul>
        <li><a href="#qu茅-es-un-m贸dulo">驴Qu茅 es un m贸dulo?</a></li>
        <li><a href="#tipos-de-m贸dulos">Tipos de m贸dulos</a></li>
        <li><a href="#jerarqu铆a-de-los-m贸dulos">Jerarqu铆a de los m贸dulos</a></li>
        <li><a href="#estructura-de-un-m贸dulo">Estructura de un m贸dulo</a></li>
        <li><a href="#configuraci贸n-de-los-m贸dulos">Configuraci贸n de los m贸dulos</a></li>
        <li><a href="#otras-consideraciones">Otras consideraciones</a></li>
      </ul>
    </li>
    <li><a href="#agentes-de-kraken">Agentes de Kraken</a>
      <ul>
        <li><a href="#qu茅-es-un-agente">驴Qu茅 es un Agente?</a></li>
        <li><a href="#tipos-de-agentes">Tipos de Agentes</a></li>
        <li><a href="#estructura-general">Estructura general</a></li>
        <li><a href="#ejecutores-disponibles">Ejecutores disponibles</a></li>
      </ul>
    </li>
    <li><a href="#conclusiones">Conclusiones</a></li>
  </ul>
</nav>
  </div>
</details>


      </div>
      </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        
<details style="margin-left:0px" class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5" >
    <summary
        class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        Kraken Fundamentals - Este art铆culo es parte de una serie.
    </summary>
    
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Parte : Este art铆culo
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://makemalware.com/es/posts/kraken-fundamentals-1/">
            Parte : Kraken Fundamentals - I
        </a>
    </div>
    
    

</details>


        <p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/featured.jpg"
        alt="Portada"
      />
      
      
    </figure>
  

</p>
<p>En la <a href="/es/posts/kraken-fundamentals-1"  >
    primera parte</a> de esta serie: &ldquo;Kraken Fundamentals&rdquo;, habl茅 acerca de lo que es Kraken y su funcionamiento a alto nivel.</p>
<p>Tras esta introducci贸n, en esta segunda parte, presentar茅 de forma detallada y en profundidad, dos componentes fundamentales en Kraken: <b><ins>los M贸dulos y los Agentes</ins></b>.</p>
<p>El objetivo consiste en explicar su dise帽o, estructura, funcionamiento y c贸mo se relacionan entre s铆.</p>
<p>Aunque este post ser谩 <em>algo m谩s extenso y detallado</em> que el anterior, confio en que sea posible comprender como opera Kraken y la posiblidad de escalarlo ante cualquier necesidad.</p>
<p>Dicho esto, y sin mayor demora&hellip; 隆Comencemos!</p>
<div id="m贸dulos-de-kraken" class="anchor">M贸dulos de Kraken></div>
<h2 class="relative group">M贸dulos de Kraken 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#m%c3%b3dulos-de-kraken" aria-label="Ancla">#</a></span>        
    
</h2><p>La primera pregunta que se debe responder al abordar esta secci贸n es la siguiente:</p>
<div id="qu茅-es-un-m贸dulo" class="anchor">驴Qu茅 es un m贸dulo?></div>
<h3 class="relative group">驴Qu茅 es un m贸dulo? 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#qu%c3%a9-es-un-m%c3%b3dulo" aria-label="Ancla">#</a></span>        
    
</h3><p>Los <strong>m贸dulos</strong> de Kraken son aquellas piezas de c贸digo que permiten realizar una o varias acciones sobre el sistema operativo en el cual se ejecuta.</p>
<p>Generalmente, un m贸dulo es una <strong>clase</strong>, en el lenguaje de programaci贸n correspondiente, que contiene toda la l贸gica para cumplir con el prop贸sito con el que se ha desarrollado. Para esto, utiliza todos los recursos disponibles en las librerias del lenguaje y/o en el sistema en el que se encuentra.</p>
<div id="tipos-de-m贸dulos" class="anchor">Tipos de m贸dulos></div>
<h3 class="relative group">Tipos de m贸dulos 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#tipos-de-m%c3%b3dulos" aria-label="Ancla">#</a></span>        
    
</h3><p>Aunque, a nivel pr谩ctico no es relevante, a nivel te贸rico existen dos tipos de m贸dulos en Kraken: <b><ins>los m贸dulos nativos y abstractos</ins></b>.</p>
<p><b><ins>Los M贸dulos Nativos</ins></b> son reimplementaciones (nativas) de comandos del sistema operativo. Permiten obtener informaci贸n similar a la que se obtendr谩 ejecutando el comando equivalente al que se pretende imitar.</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/ls_kraken_and_unix.png"
        alt="M贸dulo &amp;ldquo;ls&amp;rdquo; de Kraken vs commando &amp;ldquo;ls&amp;rdquo; Unix"
      />
      
      
    </figure>
  

</p>
<p>Estos m贸dulos pueden ser de gran utilidad en la primera fase de reconocimiento. Pues, en ese momento, se desconoce la posible existencia de soluciones de seguridad u otros productos defensivos. De esta forma, se presenta una alternativa para evitar ser detectados nada m谩s comenzar con la post-explotaci贸n.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >No obstante, la exactitud con la que se puede recrear la funcionalidad de un comando del sistema, <ins>depender谩 completamente del lenguaje de programaci贸n utilizado y del contexto</ins>. Pues, en algunas tecnolog铆as puede verse una ausencia de funcionalidades por la incapacidad de realizar seg煤n que acciones.</span>
</div>

<p>Por otro lado, <b><ins>los M贸dulos Abstractos</ins></b> no se corresponden con comandos del sistema, sino que realizan una acci贸n m谩s compleja y que <ins>se abstrae del sistema operativo en cuesti贸n</ins>. Un ejemplo de comando abstracto podr铆a ser: la subida y descarga de archivos, o por ejemplo, un m贸dulo para realizar un escaneo de puertos local o remoto.</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_upload_and_download_modules.png"
        alt="M贸dulos Upload y Download de Kraken"
      />
      
      
    </figure>
  

</p>
<div id="jerarqu铆a-de-los-m贸dulos" class="anchor">Jerarqu铆a de los m贸dulos></div>
<h3 class="relative group">Jerarqu铆a de los m贸dulos 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jerarqu%c3%ada-de-los-m%c3%b3dulos" aria-label="Ancla">#</a></span>        
    
</h3><p>Un detalle importante a conocer acerca de los m贸dulos es: <strong>c贸mo estan organizados</strong>. Pues su disposici贸n y convenci贸n permite a Kraken seleccionar los m贸dulos que necesita en el momento en el que los precisa.</p>
<p>Para explicar la jerarqu铆a, tenemos que situarnos en la carpeta <code>modules/</code> en la ra铆z del proyecto. Este directorio tiene la siguiente apariencia:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl"> modules
</span></span><span class="line"><span class="cl">     modules.py            <span class="c1"># config de los m贸dulos</span>
</span></span><span class="line"><span class="cl">     template.php          <span class="c1"># plantillas de ejemplo</span>
</span></span><span class="line"><span class="cl">     template.java
</span></span><span class="line"><span class="cl">     template.cs
</span></span><span class="line"><span class="cl">     <span class="nb">cd</span>                    <span class="c1"># directorio del m贸dulo</span>
</span></span><span class="line"><span class="cl">         cd.cs4.cs         <span class="c1"># implementaci贸n en .NET 4</span>
</span></span><span class="line"><span class="cl">         cd.java1.7.java   <span class="c1"># implementaci贸n en Java 7</span>
</span></span><span class="line"><span class="cl">         cd.java1.8.java
</span></span><span class="line"><span class="cl">         cd.php5.php       <span class="c1"># implementaci贸n en PHP 5</span>
</span></span><span class="line"><span class="cl">         cd.php7.php
</span></span><span class="line"><span class="cl">         cd.php8.php
</span></span></code></pre></div><p>Por un lado, tenemos las <b><ins>plantillas</ins></b>: que son archivos modelo para la creaci贸n de m贸dulos en sus respectivos lenguajes. Tambi茅n podemos encontrar el archivo <code>modules.py</code> el cual contiene <ins>la definici贸n y configuraci贸n</ins> de todos los m贸dulos de Kraken (esto lo explicar茅 m谩s adelante).</p>
<p>Y por otro lado, tenemos diferentes directorios que se corresponden con los m贸dulos que hay disponibles.</p>
<p>Como se puede observar, dentro de cada uno de estos directorios, se encuentran las diferentes versiones de cada m贸dulo desarrolladas en los lenguajes de programaci贸n soportados. <strong>La convenci贸n de nombres</strong> que se sigue es la siguiente:</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/module_format.png"
        alt="Formato de nombres de los m贸dulos de Kraken"
      />
      
      
    </figure>
  

</p>
<p>Este formato es importante pues:</p>
<ol>
<li><b><ins>Permite la separaci贸n entre los lenguajes de programaci贸n utilizados</ins></b> (ya que hay m贸dulos que s贸lo estan disponibles en determinados lenguajes).</li>
<li><b><ins>Facilita el versionado de los m贸dulos</ins></b> que permite contemplar diferentes implementaciones en funci贸n de la versi贸n del lenguaje de programaci贸n o tecnolog铆a (esto es 煤til de cara a la <strong>retrocompatibilidad</strong>, pues si utilizamos funciones del lenguaje relativamente nuevas, nuestro m贸dulos no funcionar谩n en versiones anteriores).</li>
<li>Para aquellos m贸dulos cuya implementaci贸n no difiera en distintas versiones, se mantiene el mismo contenido pero <b><ins>utilizando un enlace simb贸lico para evitar el duplicado de archivos</ins></b>.</li>
</ol>
<p>Con esta informaci贸n, Kraken, en tiempo de ejecuci贸n sabe, con qu茅 tipo de agente se esta comunicando, y es capaz de ofrecer al operador aquellos m贸dulos que puedan ser ejecutados en el contexto en el que se encuentra.</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_autocompleter.gif"
        alt="Autocompletado de comandos en Kraken"
      />
      
      
    </figure>
  

</p>
<p>Un ejemplo de esto es: si no dispones del m贸dulo &ldquo;ls&rdquo; para la versi贸n 5.4 de PHP, Kraken no te lo mostrar谩 en la tty. En cambio, si tienes un m贸dulo para todas las subversiones de PHP 5, entonces Kraken si te permitir谩 utilizarlo.</p>
<div id="estructura-de-un-m贸dulo" class="anchor">Estructura de un m贸dulo></div>
<h3 class="relative group">Estructura de un m贸dulo 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#estructura-de-un-m%c3%b3dulo" aria-label="Ancla">#</a></span>        
    
</h3><p>La estructura de los m贸dulos de Kraken puede variar ligeramente entre lenguajes de programaci贸n (pues cada uno tiene sus m茅todos de carga y eso afecta a su implementaci贸n), no obstante, los m贸dulos se han dise帽ado para que sigan una idea com煤n.</p>
<p>Para mostrar este patr贸n entre m贸dulos, se utilizar谩 como ejemplo <strong>la plantilla Java actual</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.text.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">javax.xml.bind.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Module_template</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SUCC_CODE</span> <span class="o">=</span> <span class="s">&#34;0&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ERR_CODE</span>  <span class="o">=</span> <span class="s">&#34;1&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">JAVA_EOL</span>  <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">lineSeparator</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="nf">hex2str</span><span class="o">(</span><span class="n">String</span> <span class="n">data</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data_bytes</span> <span class="o">=</span> <span class="n">DatatypeConverter</span><span class="o">.</span><span class="na">parseHexBinary</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">data_string</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">data_bytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">data_string</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="nf">normalizePath</span><span class="o">(</span><span class="n">String</span> <span class="n">currPath</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">currPath</span> <span class="o">=</span> <span class="n">currPath</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">&#34;\&#34;&#34;</span><span class="o">,</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">currPath</span> <span class="o">=</span> <span class="n">currPath</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">&#34;&#39;&#34;</span><span class="o">,</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">currPath</span> <span class="o">=</span> <span class="n">currPath</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">&#34;\\&#34;</span><span class="o">,</span> <span class="s">&#34;/&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">currPath</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">parseArgs</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">regex</span> <span class="o">=</span> <span class="s">&#34;\&#34;[^\&#34;]+\&#34;|&#39;[^&#39;]+&#39;|\\S+&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">arguments</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">            <span class="n">arguments</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">String</span><span class="o">[]</span> <span class="n">arguments_arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">arguments</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
</span></span><span class="line"><span class="cl">        <span class="n">arguments_arr</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="n">arguments_arr</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">arguments_arr</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="nf">changeCWD</span><span class="o">(</span><span class="n">String</span> <span class="n">cwd</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">File</span> <span class="n">target_dir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">cwd</span><span class="o">).</span><span class="na">getAbsoluteFile</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">target_dir</span><span class="o">.</span><span class="na">exists</span><span class="o">()</span> <span class="o">==</span> <span class="kc">false</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="o">(</span><span class="s">&#34;Directory: &#39;&#34;</span> <span class="o">+</span> <span class="n">cwd</span> <span class="o">+</span> <span class="s">&#34;&#39;: does not exist&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">target_dir</span><span class="o">.</span><span class="na">canRead</span><span class="o">()</span> <span class="o">==</span> <span class="kc">false</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="o">(</span><span class="s">&#34;Can&#39;t move to path: &#39;&#34;</span> <span class="o">+</span> <span class="n">cwd</span> <span class="o">+</span> <span class="s">&#34;&#39;: permission denied&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">target_dir</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">()</span> <span class="o">==</span> <span class="kc">false</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="o">(</span><span class="s">&#34;Path: &#39;&#34;</span> <span class="o">+</span> <span class="n">cwd</span> <span class="o">+</span> <span class="s">&#34;&#39;: is not a directory&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;user.dir&#34;</span><span class="o">,</span> <span class="n">target_dir</span><span class="o">.</span><span class="na">getCanonicalPath</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">normalizePath</span><span class="o">(</span><span class="n">target_dir</span><span class="o">.</span><span class="na">getCanonicalPath</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">doAction</span><span class="o">(</span><span class="n">String</span> <span class="n">param_one</span><span class="o">,</span> <span class="n">String</span> <span class="n">param_two</span><span class="o">,</span> <span class="n">String</span> <span class="n">param_three</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;do something&#34;</span> <span class="o">+</span> <span class="n">JAVA_EOL</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="n">ERR_CODE</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">ToString</span><span class="o">()</span> <span class="o">+</span> <span class="n">JAVA_EOL</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="n">SUCC_CODE</span><span class="o">,</span> <span class="n">output</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">execute</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="n">ERR_CODE</span><span class="o">,</span> <span class="s">&#34;Invalid arguments provided. Only one directory is allowed to be moved&#34;</span> <span class="o">+</span> <span class="n">JAVA_EOL</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">doAction</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">go</span><span class="o">(</span><span class="n">String</span> <span class="n">module_cwd</span><span class="o">,</span> <span class="n">String</span> <span class="n">module_args</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">new_cwd</span> <span class="o">=</span> <span class="n">changeCWD</span><span class="o">(</span><span class="n">hex2str</span><span class="o">(</span><span class="n">module_cwd</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parseArgs</span><span class="o">(</span><span class="n">hex2str</span><span class="o">(</span><span class="n">module_args</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="n">ERR_CODE</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span> <span class="o">+</span> <span class="n">JAVA_EOL</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Module_template</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Module_template</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span><span class="o">[]</span> <span class="n">results</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">results</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Tras examinar el c贸digo de la plantilla, <ins>se destacan</ins> algunos aspectos de inter茅s:</p>
<ol>
<li><b><ins>El m贸dulo consta de una Clase</ins></b>, la cual es instanciada e invocada (el modo depender谩 del <strong>ejecutor</strong> utilizado en cada tecnolog铆a) pero en todas se sigue esta l铆nea.</li>
<li>En esta clase podemos ver un m茅todo <strong>&ldquo;main&rdquo;</strong> el cu谩l es importante pues, <b><ins>el m贸dulo debe poderse compilar en local y ejecutarse</ins></b>. De esta forma, puedes mantener una estructura c贸mun que te permita que los mismo m贸dulos que Kraken invoca, sean facilmente compilables y ejecutables en local (obviamente con sus modificaciones pertinentes).</li>
</ol>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_java_local_compilation.png"
        alt="Compilaci贸n local de m贸dulo Java de Kraken"
      />
      
      
    </figure>
  

</p>
<ol start="3">
<li>Los m贸dulos, deben tener un m茅todo p煤blico: <code>go()</code> que permita pasar los argumentos necesarios desde el agente al m贸dulo. El flujo de esta funci贸n es el siguiente:
<ol>
<li>Con <code>hex2str()</code>, obtenemos los valores de los argumentos que se pasan en formato hexadecimal al m贸dulo.</li>
<li>Con <code>changeCWD()</code> se establece el &ldquo;Current Working Directory&rdquo; (cwd) del m贸dulo. Pues el cambio entre directorios se tiene que mantener en el cliente y enviar la referencia al agente.</li>
<li>Despu茅s se procesan los argumentos con <code>parseArgs()</code>, que los devuelve en un array listos para ser utilizados por el m贸dulo.</li>
<li>Finalmente, se llama al m茅todo <code>execute()</code> que se encargar谩 de procesar los argumentos e invocar a la funci贸n que realiza la acci贸n objetivo.</li>
</ol>
</li>
</ol>
<blockquote>
<p>El concepto de esta funci贸n <code>go()</code> es similar a c贸mo se utiliza en los <strong>BOF de Cobaltstrike</strong><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
</blockquote>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    ><strong>Es importante destacar que:</strong> en el caso de PHP, la funci贸n <code>go()</code> es suprimida debido a que, el ejecutor que hay por defecto en PHP, evalua el c贸digo del m贸dulo tal cual. Esto hace que no sea necesario instanciar la clase y llamar al m茅todo (como har铆amos en Java o .NET) sino ejecutar el c贸digo directamente.</span>
</div>

<ol start="4">
<li>Tras esto, se acaba llamando a la funci贸n <code>do...()</code> que se encargar谩 de realizar las acciones para las cuales se ha desarrollado el m贸dulo. Este m茅todo devolver谩 un array con <strong>dos elementos</strong>:
<ol>
<li><b><ins>El odigo de retorno o estado (status_code):</ins></b> el que indica si la ejecuci贸n ha sido exitosa o no.</li>
<li><b><ins>El resultado</ins></b> como contenido del mensaje a mostrar (message).</li>
</ol>
</li>
<li>Por 煤ltimo, tanto las funciones previas al <code>doAction()</code> de este ejemplo, como los atributos de la clase, ser谩n elementos imprescindibles para que los m贸dulos funcionen. Por ello es importante utilizar las plantillas disponibles para que los m贸dulos sigan el mismo formato.</li>
</ol>
<p>En futuros posts hablar茅 acerca de la creaci贸n de los m贸dulos (y otros elementos de Kraken) y c贸mo utilizarlos.</p>
<div id="configuraci贸n-de-los-m贸dulos" class="anchor">Configuraci贸n de los m贸dulos></div>
<h3 class="relative group">Configuraci贸n de los m贸dulos 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#configuraci%c3%b3n-de-los-m%c3%b3dulos" aria-label="Ancla">#</a></span>        
    
</h3><p>Ahora bien, los m贸dulos de Kraken, no son s贸lo archivos de c贸digo, pues tambi茅n deben aportar unas caracter铆sticas para poder ser utilizados, por ejemplo:</p>
<ul>
<li><strong>驴Qu茅 argumentos necesita? 驴Y de qu茅 tipo?</strong></li>
<li><strong>驴Para qu茅 tecnolog铆as esta disponible?</strong></li>
<li><strong>驴Se puede utilizar en cualquier Sistema Operativo?</strong></li>
<li><strong>驴C贸mo debe funcionar el m贸dulo? 驴Debe interactuar con alg煤n elemento del cliente?</strong></li>
<li><strong>驴C贸mo se debe mostrar el resultado de la ejecuci贸n?</strong></li>
</ul>
<p>Estas y m谩s preguntas son respondidas en el archivo: <code>modules/modules.py</code> que hemos mencionado anteriormente.</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_modules_config.png"
        alt="Archivo de configuraci贸n de los m贸dulos de Kraken"
      />
      
      
    </figure>
  

</p>
<p>Por medio de esta estructura en lenguaje Python, Kraken es capaz de entender <b><ins>c贸mo debe tratar a cada m贸dulo existente</ins></b>. Para mostrar cada uno de los campos, se utilizar谩 la configuraci贸n relativa al m贸dulo <code>ls</code> como ejemplo:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;ls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;template&#34;</span> <span class="p">:</span> <span class="s2">&#34;ls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;description&#34;</span> <span class="p">:</span> <span class="s2">&#34;List files or directories&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;author&#34;</span> <span class="p">:</span> <span class="s2">&#34;@secu_x11&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;examples&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ls&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ls ..&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ls /etc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ls -R /etc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ls C:/Users&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;so&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Linux&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;agents&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;php&#34;</span><span class="p">,</span><span class="s2">&#34;java&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Windows&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;agents&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;php&#34;</span><span class="p">,</span><span class="s2">&#34;java&#34;</span><span class="p">,</span><span class="s2">&#34;cs&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;args&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;-R&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;help&#34;</span><span class="p">:</span> <span class="s2">&#34;Recursive mode&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;action&#34;</span> <span class="p">:</span> <span class="s2">&#34;store_true&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;required&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;files&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;help&#34;</span><span class="p">:</span> <span class="s2">&#34;Files to list&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;nargs&#34;</span> <span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;type&#34;</span><span class="p">:</span>  <span class="nb">str</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;dispatcher&#34;</span> <span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;formater&#34;</span> <span class="p">:</span> <span class="s2">&#34;columns&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>A continuaci贸n se detallan algunos de los campos que pueden despertar preguntas:</p>
<ul>
<li><b><ins>Template:</ins></b> corresponde al nombre de la plantilla que se utilizar谩 en la jerarqu铆a de archivos del directorio <code>modules/</code> (este suele/debe coincidir con el nombre del m贸dulo en cuesti贸n).</li>
<li><b><ins>Sistema Operativo:</ins></b> aqu铆 se plasma la informaci贸n acerca de los sistemas operativos y tecnolog铆as para los cuales esta soportado el m贸dulo.</li>
<li><b><ins>Argumentos:</ins></b> lo 煤nico a destacar acerca de este campo, es que los argumentos son definidos con la estructura que utiliza <code>argparser</code>. De esta forma, se puede delegar la validaci贸n de los argumentos a esta librer铆a.</li>
<li><b><ins>Dispatcher:</ins></b> aqu铆 figura el nombre del componente que se encargar谩 de definir c贸mo es procesado el m贸dulo por el Cliente de Kraken (de esto se hablar谩 m谩s adelante).</li>
<li><b><ins>Formater:</ins></b> de igual forma que con el dispatcher, el formater es un componente que define como deben mostrarse los resultados que devuelve el agente.</li>
</ul>
<div id="otras-consideraciones" class="anchor">Otras consideraciones></div>
<h3 class="relative group">Otras consideraciones 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#otras-consideraciones" aria-label="Ancla">#</a></span>        
    
</h3><p>Otro detalle de importancia es que, gracias a esta jerarqu铆a, el operador puede hacer <b><ins>&ldquo;edici贸n en caliente&rdquo;</ins></b> de los m贸dulos.</p>
<p>Por ejemplo, puede suceder que, se desarrolle un m贸dulo de post-explotaci贸n para Kraken, y&hellip; al ejecutarse, este no devuelva la informaci贸n que se espera o directamente falle. En ese caso, <b><ins>es posible editar el contenido del m贸dulo en disco y volver a ejecutarlo</ins></b> (en PHP y .NET) o recompilarlo (en Java).</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_hot_fixes_module.png"
        alt="Edicci贸n en caliente de m贸dulo de Kraken"
      />
      
      
    </figure>
  

</p>
<p>De esta forma, se aporta una cierta flexibilidad al operador que puede ajustar su intrusi贸n al entorno en el que se encuentra.</p>
<div id="agentes-de-kraken" class="anchor">Agentes de Kraken></div>
<h2 class="relative group">Agentes de Kraken 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#agentes-de-kraken" aria-label="Ancla">#</a></span>        
    
</h2><p>Para que los m贸dulos sean ejecutados y se obtenga la respuesta, estos deben ser recibidos y procesados por el otro componente fundamental en Kraken: <b><ins>los Agentes</ins></b>.</p>
<div id="qu茅-es-un-agente" class="anchor">驴Qu茅 es un Agente?></div>
<h3 class="relative group">驴Qu茅 es un Agente? 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#qu%c3%a9-es-un-agente" aria-label="Ancla">#</a></span>        
    
</h3><p>Un Agente de Kraken es un archivo que se situa en un directorio accesible del servicio web y <b><ins>permite la carga de m贸dulos de Kraken</ins></b>. Para ello, <strong>recibe, procesa e interpreta</strong> el contenido de los m贸dulos y argumentos necesarios para su correcta ejecuci贸n.</p>
<div id="tipos-de-agentes" class="anchor">Tipos de Agentes></div>
<h3 class="relative group">Tipos de Agentes 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#tipos-de-agentes" aria-label="Ancla">#</a></span>        
    
</h3><p>Actualmente, los agentes se pueden encontrar bajo el directorio <code>agents/</code>. Existen <strong>2 tipos</strong> de agentes que son:</p>
<ul>
<li><b><ins>Agentes Standard:</ins></b> para utilizar con el modo <code>st</code>.</li>
<li><b><ins>Agentes Command-and-Control:</ins></b> para utilizar con el modo <code>c2</code>.</li>
</ul>
<p>Bajo el subdirectorio <code>c2/</code> simplemente se encuentra un s贸lo agente, ya que en este momento s贸lo me ha dado tiempo de realizar la implementaci贸n en PHP. Este modo es <strong>&ldquo;experimental&rdquo;</strong> y a煤n no ha sido testeado por completo. No obstante es usable y funciona correctamente.</p>
<p>Por otro lado, en el subdirectorio <code>st/</code> podemos encontrar <strong>3 versiones</strong> de agentes que se corresponden a las tecnolog铆as disponibles: <b><ins>PHP, Java y .NET</ins></b></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >En futuras versiones de Kraken, se a帽adir谩 la posibilidad de utilizar <b><ins>un generador de Webshells</ins></b> que permita seleccionar entre distintos tipos de Webshells en funci贸n del entorno y caracter铆sticas que se desea. Por ahora, <b><ins>las webshells/agentes disponibles son fijas</ins></b> y deben modificarse algunos campos en su interior para customizar su uso.</span>
</div>

<div id="estructura-general" class="anchor">Estructura general></div>
<h3 class="relative group">Estructura general 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#estructura-general" aria-label="Ancla">#</a></span>        
    
</h3><p>La estructura del Agente var铆a en funci贸n de su tipo. Aunque, al igual que los m贸dulos, estos siguen un mismo patr贸n. El siguiente diagrama muestra, de forma simplificada, <b><ins>el flujo de un Agente de Kraken</ins></b>:</p>
<div class="mermaid" align="center">
  
graph TD;
    A[Agente] -->|Recibe petici贸n HTTP| B{Autenticaci贸n}
    B --> |Incorrecta| C(Devolver Respuesta)
    B --> |Correcta| D[Handle]
    D --> E{Extracci贸n de \nPar谩metros}
    E --> |Inv谩lidos| C
    E --> |V谩lidos| F{Comprobar C贸digo \nde Acci贸n}
    F --> |Inexistente| C
    F --> |Existente| G[Invocar Acci贸n]
    G --> H[Extracci贸n de \nla Respuesta]
    H --> C

</div>

<p>Los agentes realizan una rigurosa comprobaci贸n de los par谩metros encapsulados en la petici贸n HTTP. Pues, a partir de estos, se realizan las acciones en funci贸n de los valores contenidos en los mismos.</p>
<p>Algunos elementos destacables en el agente son:</p>
<ul>
<li><b><ins>Autenticaci贸n:</ins></b> el primer paso para que la comunicaci贸n entre Cliente y Agente de Kraken sea exitosa, consiste en un proceso de autenticaci贸n mediante una clave sim茅trica:
<ul>
<li><ins>La clave debe ser conocida por el Agente y por el Cliente</ins> (de esto se hablar谩 en profundidad en el siguiente post).</li>
<li>La misma clave de autenticaci贸n <ins>se utiliza para cifrar el contenido de los m贸dulos y argumentos</ins>.</li>
<li>El proceso de cifrado y descifrado es <ins>una simple operaci贸n XOR</ins> sobre el valor la clave elegida en ambos extremos.</li>
</ul>
</li>
</ul>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/editable_fields_of_agent_cs.png"
        alt="Campos editables en Agente .NET"
      />
      
      
    </figure>
  

</p>
<ul>
<li><b><ins>Extracci贸n de Par谩metros:</ins></b> tanto el m贸dulo como los argumentos necesarios, son encapsulados en la petici贸n HTTP por parte del Cliente. Al igual que este encapsula, el Agente deber谩 conocer d贸nde son incrustados pues tiene que realizar su proceso inverso para obtenerlos. Esta informaci贸n es relativa a los <ins>Perfiles de Conexi贸n</ins> que se explicar谩n m谩s adelante:</li>
</ul>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_php_agent_param_extraction.png"
        alt="Extracci贸n de Par谩metros en el Agente PHP"
      />
      
      
    </figure>
  

</p>
<ul>
<li>
<p><b><ins>C贸digos de Acciones:</ins></b> los agentes tienen varios tipos de acciones, estos son indicados en funci贸n de <ins>un valor entero</ins> que se envia por el Cliente. Aunque se entrar谩 en detalle en los siguientes posts, se citan a continuaci贸n los posibles valores:</p>
<ul>
<li><strong>Consulta de Estado</strong> (STATUS)</li>
<li><strong>Carga de m贸dulos</strong> (LOAD)</li>
<li><strong>Invocaci贸n de m贸dulo</strong> (INVOKE)</li>
<li><strong>Descarga de m贸dulo</strong> (UNLOAD)</li>
<li><strong>Limpieza de m贸dulos</strong> (CLEAN)</li>
</ul>
</li>
<li>
<p><b><ins>Invocaci贸n:</ins></b> una vez se ha decidido que acci贸n realizar, se procede a su invocaci贸n. En este caso, lo m谩s relevante es hablar acerca de la <strong>acci贸n &ldquo;INVOKE&rdquo;</strong>, que es la que se utiliza para ejecutar el m贸dulo enviado por el cliente:</p>
</li>
</ul>
<div id="ejecutores-disponibles" class="anchor">Ejecutores disponibles></div>
<h3 class="relative group">Ejecutores disponibles 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ejecutores-disponibles" aria-label="Ancla">#</a></span>        
    
</h3><p>Los encargados de realizar esta evaluaci贸n o ejecuci贸n del m贸dulo recibido toman el nombre de <b><ins>Ejecutores</ins></b>.</p>
<p>Cada ejecutor tiene su forma particular de tratar al m贸dulo y, dependiendo de este, el cliente tendr谩 que enviarlo en el formato adecuado. Por ello es importante elegir bien el agente utilizado a la hora de su despliegue.</p>
<p><ins>Los ejecutores utilizan las funciones de la tecnolog铆a en uso para conseguir ejecutar el c贸digo del m贸dulo</ins>. Actualmente el listado de los que son soportados es el siguiente:</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_executors_es.png"
        alt="Ejecutores disponibles en los Agentes de Kraken"
      />
      
      
    </figure>
  

</p>
<blockquote>
<p>Nota: obviamente hay m谩s funcionalidades que te permiten ejecutar c贸digo<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> en estos tres lenguajes de programaci贸n pero, para este momento, se ha decidido centrar los esfuerzos en uno de ellos suficientemente vers谩til para poner el foco en otros puntos de mayor inter茅s.</p>
</blockquote>
<p>Al momento de realizar su invocaci贸n, se pasan los argumentos requeridos directamente al m贸dulo de la forma indicada. Para este caso se ejemplificar谩 con <strong>el ejecutor por defecto del agente Standard en Java</strong>:</p>
<p>




  
  
    
  
  
    <figure>
      
      <img
        class="my-0 rounded-md"
        src="/es/posts/kraken-fundamentals-2/images/kraken_java_executor.png"
        alt="Ejecutor por defecto del Agente Java de Kraken"
      />
      
      
    </figure>
  

</p>
<p>El resultante de la ejecuci贸n es un array de dos elementos del tipo String que contiene el c贸digo de estado (return code) y el resultado de la ejecuci贸n (message). Con estos datos, se puede retornar la respuesta al Cliente encapsulando la informaci贸n en su lugar correspondiente.</p>
<p>Al recibirla, el Cliente determinar谩 como mostrar esta respuesta, pero esto ya es otra historia por contar.</p>
<div id="conclusiones" class="anchor">Conclusiones></div>
<h2 class="relative group">Conclusiones 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusiones" aria-label="Ancla">#</a></span>        
    
</h2><p>Llegados a este punto, se concluye esta segunda parte de la serie. Obviamente, aun quedan muchas dudas por resolver y muchos conceptos por explicar.</p>
<p>En el siguiente post hablar茅 acerca de <b><ins>los 2 modos que existen actualmente en Kraken (ST y C2)</ins></b>. Tambi茅n explicar茅 en profundidad <b><ins>c贸mo es la comunicaci贸n entre Cliente y Agente</ins></b>. Desglosando <strong>la estructura del paso de mensajes</strong> que se utiliza y mostrando todo el potencial que aporta.</p>
<p>隆Espero que os haya gustado el post y nos vemos muy pronto!</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>CobaltStrike Beacon Object File (BOF) : <a href="https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_main.htm"   target="_blank">
    https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_main.htm</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Alternative code execution methods in Java: <a href="https://medium.com/@m01e/jsp-webshell-cookbook-part-1-6836844ceee7"   target="_blank">
    https://medium.com/@m01e/jsp-webshell-cookbook-part-1-6836844ceee7</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

        </br></br>
        
<details style="margin-left:0px" class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5">
    <summary
        class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        Kraken Fundamentals - Este art铆culo es parte de una serie.
    </summary>
    
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Parte : Este art铆culo
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://makemalware.com/es/posts/kraken-fundamentals-1/">
            Parte : Kraken Fundamentals - I
        </a>
    </div>
    
    

</details>


      </div>
      <script>
        var oid = "views_posts\/kraken-fundamentals-2\/index.es.md"
        var oid_likes = "likes_posts\/kraken-fundamentals-2\/index.es.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js" integrity="sha512-DkmXO0rQo4LHxgEti/&#43;CJjFmQtqrxPiiBHe9CGdPPabi&#43;pk7wgrU9R58W7aOb5E6IHp8T&#43;N&#43;oOe4BolK/OCmTg=="></script>
  </section>
  <footer class="pt-8 max-w-prose print:hidden">

    


    
    
    

    

    
    

    
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://makemalware.com/es/posts/kraken-fundamentals-2/&amp;title=Kraken%20Fundamentals%20-%20II"
      title="Compartir en LinkedIn"
      aria-label="Compartir en LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://makemalware.com/es/posts/kraken-fundamentals-2/&amp;text=Kraken%20Fundamentals%20-%20II"
      title="Tuitear en Twitter"
      aria-label="Tuitear en Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://reddit.com/submit/?url=https://makemalware.com/es/posts/kraken-fundamentals-2/&amp;resubmit=true&amp;title=Kraken%20Fundamentals%20-%20II"
      title="Publicar en Reddit"
      aria-label="Publicar en Reddit"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=https://makemalware.com/es/posts/kraken-fundamentals-2/&amp;quote=Kraken%20Fundamentals%20-%20II"
      title="Compartir en Facebook"
      aria-label="Compartir en Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://makemalware.com/es/posts/kraken-fundamentals-2/&amp;subject=Kraken%20Fundamentals%20-%20II"
      title="Enviar v铆a email"
      aria-label="Enviar v铆a email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/es/posts/kraken-fundamentals-1/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Kraken Fundamentals - I</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-01-09 00:00:00 &#43;0000 UTC">9 enero 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/es/posts/squid-game-ctf/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Squid Game CTF - Hc0n 2023</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-03-01 00:00:00 &#43;0000 UTC">1 marzo 2023</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Ir arriba" title="Ir arriba">
    &uarr;
  </a>
</div>
    </main><footer class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/es/tags/"
            title="Tags">Tags</a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/es/categories/"
            title="Categories">Categorias</a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/es/authors/"
            title="Authors">Autores</a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      漏 Copyright 2022 - MakeMalware
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Desarrollada con <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.2166d3adac1679c00a75161830ab5725d3efc0e3d3f8c2453fb01d0907948436c25f0f8a7ad824322fa22f3f9c85fd4d0a1d5c856f53b862157da25a57dc3d52.js" integrity="sha512-IWbTrawWecAKdRYYMKtXJdPvwOPT&#43;MJFP7AdCQeUhDbCXw&#43;KetgkMi&#43;iLz&#43;chf1NCh1chW9TuGIVfaJaV9w9Ug=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://makemalware.com/es/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Buscar"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Cerrar (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
  data-id="secu77" data-description="Support me on Buy me a coffee!" data-message=""
  data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
